---
title: Rust Axum 依赖注入模式
created: 2025-09-08 13:38
---
<!-- markdownlint-disable MD025 -->

# Rust Axum 依赖注入模式

在软件工程中， **依赖注入** （dependency injection）的意思为，给予调用方它所需要的事物。“依赖”是指可被方法调用的事物。依赖注入形式下，调用方不再直接指使用“依赖”，取而代之是“注入” 。“注入”是指将“依赖”传递给调用方的过程。在“注入”之后，调用方才会调用该“依赖”。传递依赖给调用方，而不是让让调用方直接获得依赖，这个是该设计的根本需求。在编程语言角度下，“调用方”为对象和类，“依赖”为变量。在提供服务的角度下，“调用方”为客户端，“依赖”为服务。

## 为什么需要依赖注入？

如果要在 Axum Websocket 服务中要保证创建的对象是单例的，并且可以有一个全局上下文，有一个bean的资源池，有连接请求需要处理时可以直接拿到全局的单例对象去操作，需要如何实现呢？这就是今天我像在这里讨论的内容。

### 依赖注入的好处

1. 避免在每个请求中重复创建昂贵的对象（如数据库连接池、外部服务客户端），从而降低服务性能开销和内存占用。
2. 确保某些服务或资源在整个应用生命周期中只有一个实例，统一管理状态和行为。
3. 方便模拟（mock）或替换依赖，进行单元测试。
4. 依赖关系清晰，修改和重构更容易。
5. 在不修改代码的情况下替换不同实现。
6. 集中管理依赖的生命周期和实例化。

## Refer

- [深入理解 Rust Axum：两种依赖注入模式的实践与对比（二）](https://zhuanlan.zhihu.com/p/1942557132047230639)
