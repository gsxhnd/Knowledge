---
title: 布隆过滤器
created: 2024-09-13 10:25
tags:
  - 算法
---
<!-- markdownlint-disable MD025 -->
<!-- markdownlint-disable MD036 -->

# 布隆过滤器 Bloom Filter

布隆过滤器（Bloom Filter）是一种空间效率非常高的概率型数据结构，用于判断一个元素是否属于一个集合。它主要用于快速检查一个元素是否可能存在于一个非常大的集合中，或者确定一个元素一定不存在于集合中。布隆过滤器的主要优点是它的空间效率和查询时间都非常高，但其缺点是存在一定的误判率。

## 布隆过滤器的工作原理

1. 位数组：布隆过滤器由一个长度为 m 的位数组（bit array）组成，初始时所有位都被设置为0。

2. 哈希函数：布隆过滤器使用 k 个不同的哈希函数，每个哈希函数将输入元素映射到位数组中的一个位置。

3. 插入元素：当插入一个元素时，使用 k 个哈希函数计算出 k 个位置，并将这些位置在位数组中设置为1。

4. 查询元素：当查询一个元素是否在集合中时，使用同样的 k 个哈希函数计算出 k 个位置，检查这些位置是否都为1。如果所有位置都为1，则认为元素可能存在于集合中（存在误判的可能）；如果任何一个位置为0，则可以确定元素一定不存在于集合中。

## 误判率

布隆过滤器的误判率（False Positive Rate）是指当一个元素不在集合中时，布隆过滤器错误地认为它在集合中的概率。误判率取决于以下几个因素：

- 位数组的大小 m：位数组越大，误判率越低。
- 哈希函数的数量 k：哈希函数越多，误判率越低，但插入和查询的时间会增加。
- 集合中元素的数量 n：集合中元素越多，误判率越高。
误判率的公式为：

$[ \text{False Positive Rate} \approx \left(1 - e^{-\frac{kn}{m}}\right)^k ]$

## 应用场景

布隆过滤器广泛应用于需要快速判断元素是否存在的场景，尤其是在内存受限的情况下。常见的应用包括：

- 缓存系统：用于快速判断一个URL是否已经被缓存过。
- 数据库系统：用于快速判断一个键是否存在于数据库中，避免不必要的磁盘I/O。
- 垃圾邮件过滤：用于快速判断一个邮件地址是否在黑名单中。
- 分布式系统：用于快速判断一个数据是否已经被处理过。
  
__优缺点__

优点：

- 空间效率高：布隆过滤器使用的空间远小于存储所有元素的空间。
- 查询速度快：查询时间复杂度为 O(k)，其中 k 是哈希函数的数量。

缺点：

- 存在误判：布隆过滤器可能会错误地认为一个不在集合中的元素在集合中。
- 不支持删除：布隆过滤器不支持删除操作，因为删除一个元素可能会影响其他元素的判断。

## 实现

The basic bloom filter supports two operations: test and add.

基础的布隆过滤器支持两个操作`test`和`add`。

## Refer

<https://www.jasondavies.com/bloomfilter/>
